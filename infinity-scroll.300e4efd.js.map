{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,uCAOA,MAAMC,EAAeC,SAASC,cAAc,gBACtCC,EAAYF,SAASC,cAAc,YAEnCE,EAAa,IAAI,EAAAC,EAAAC,YAEjBC,EAAW,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAChDC,aAAc,MACdC,aAAc,MAsBhB,MAAMC,EAAW,IAAIC,sBACnB,CAACC,EAASC,KACJD,EAAQ,GAAGE,gBArBnBC,eAA4BC,GACxBd,EAAWe,MAAQ,EAErB,IACE,MAAMC,QAAiBhB,EAAWiB,mBAE9BjB,EAAWe,KAAOf,EAAWkB,SAAWF,EAASG,KAAKC,WACxDZ,EAASa,UAAUxB,SAASC,cAAc,oBAG5CC,EAAUuB,mBACR,aACA,EAAAC,EAAAC,SAAmBR,EAASG,KAAKM,OAEnC,MAAOC,GACPC,QAAQC,IAAIF,IAOVG,KAGJ,CACEC,KAAM,KACNC,WAAY,QACZC,UAAW,IAIfpC,EAAaqC,iBAAiB,UAE9BpB,eAAkCC,GAC9BA,EAAMoB,iBACNlC,EAAWmC,EAAIrB,EAAMsB,cAAcC,SAAsB,YAAEC,MAC3DtC,EAAWe,KAAO,EAElB,IACE,MAAMC,QAAiBhB,EAAWiB,mBAElC,GAAkC,IAA9BD,EAASG,KAAKM,KAAKc,OAIrB,OAHAnC,EAAAV,GAAS8C,OAAOC,QAAQ,4EACxB1C,EAAU2C,UAAY,QACtB5B,EAAM6B,OAAOC,QAQf,GAJAxC,EAAAV,GAAS8C,OAAOK,QACd,qBAAqB7B,EAASG,KAAKC,sBAGjCJ,EAASG,KAAKC,WAAapB,EAAWkB,SAGxC,OAFAnB,EAAU2C,WAAY,EAAAnB,EAAAC,SAAmBR,EAASG,KAAKM,WACvDtB,EAAS2C,UAIX/C,EAAU2C,WAAY,EAAAnB,EAAAC,SAAmBR,EAASG,KAAKM,MACvDtB,EAAS2C,UACT,MAAOpB,GACPC,QAAQC,IAAIF","sources":["src/js/infinity-scroll.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { PixabayAPI } from './pixabay-api';\nimport createGalleryCards from '../templates/gallery-card.hbs';\n\nconst searchFormEl = document.querySelector('.search-form');\nconst galleryEl = document.querySelector('.gallery');\n\nconst pixabayAPI = new PixabayAPI();\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nasync function loadMoreData(event) {\n    pixabayAPI.page += 1;\n\n  try {\n    const response = await pixabayAPI.getPhotosByQuery();\n\n    if (pixabayAPI.page * pixabayAPI.per_page > response.data.totalHits) {\n      observer.unobserve(document.querySelector('.target-element'));\n    }\n\n    galleryEl.insertAdjacentHTML(\n      'beforeend',\n      createGalleryCards(response.data.hits)\n    );\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst observer = new IntersectionObserver(\n  (entries, observer) => {\n    if (entries[0].isIntersecting) {\n      loadMoreData();\n    }\n  },\n  {\n    root: null,\n    rootMargin: '600px',\n    threshold: 1,\n  }\n);\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\n\nasync function onSearchFormSubmit(event) {\n    event.preventDefault();\n    pixabayAPI.q = event.currentTarget.elements['searchQuery'].value;\n    pixabayAPI.page = 1;\n  \n    try {\n      const response = await pixabayAPI.getPhotosByQuery();\n\n      if (response.data.hits.length === 0) {\n        Notiflix.Notify.failure('Sorry, there are no images matching your search query. Please try again.');\n        galleryEl.innerHTML = '';\n        event.target.reset();\n        return;\n      }\n  \n      Notiflix.Notify.success(\n        `'Hooray! We found ${response.data.totalHits} images.'`\n      );\n  \n      if (response.data.totalHits <= pixabayAPI.per_page) {\n        galleryEl.innerHTML = createGalleryCards(response.data.hits);\n        lightbox.refresh();\n        return;\n      }\n    \n      galleryEl.innerHTML = createGalleryCards(response.data.hits);\n      lightbox.refresh();\n    } catch (err) {\n      console.log(err);\n    }\n  }\n  "],"names":["$eWCmQ","parcelRequire","$0294d88c66beb492$var$searchFormEl","document","querySelector","$0294d88c66beb492$var$galleryEl","$0294d88c66beb492$var$pixabayAPI","$6fOXY","PixabayAPI","$0294d88c66beb492$var$lightbox","$parcel$interopDefault","$fZKcF","captionsData","captionDelay","$0294d88c66beb492$var$observer","IntersectionObserver","entries","observer","isIntersecting","async","event","page","response","getPhotosByQuery","per_page","data","totalHits","unobserve","insertAdjacentHTML","$cdIRi","default","hits","err","console","log","$0294d88c66beb492$var$loadMoreData","root","rootMargin","threshold","addEventListener","preventDefault","q","currentTarget","elements","value","length","Notify","failure","innerHTML","target","reset","success","refresh"],"version":3,"file":"infinity-scroll.300e4efd.js.map"}